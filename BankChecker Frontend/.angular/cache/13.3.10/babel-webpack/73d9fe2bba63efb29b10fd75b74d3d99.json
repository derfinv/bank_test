{"ast":null,"code":"import { Router } from '@angular/router';\nimport { NotificationType } from '../enum/notification-type.enum';\nimport { Expense } from '../model/expense';\nimport { User } from '../model/user';\nimport { AuthenticationService } from '../service/authentication.service';\nimport { ExpenseService } from '../service/expense.service';\nimport { NotificationService } from '../service/notification.service';\nimport { UserService } from '../service/user.service';\nimport { DatePipe } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/expense.service\";\nimport * as i2 from \"../service/user.service\";\nimport * as i3 from \"../service/notification.service\";\nimport * as i4 from \"../service/authentication.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\nfunction HomepageComponent_tr_58_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 50);\n    i0.ɵɵlistener(\"click\", function HomepageComponent_tr_58_Template_tr_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const expense_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.onEditExpense(expense_r2);\n    });\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const expense_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 3, expense_r2.date, \"dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", expense_r2.value, \"\\u20AC\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(expense_r2.notes);\n  }\n}\nfunction HomepageComponent_div_59_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵelementStart(2, \"h1\");\n    i0.ɵɵtext(3, \"Non sono state effettuate spese durante questa settimana.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let HomepageComponent = /*#__PURE__*/(() => {\n  class HomepageComponent {\n    constructor(expenseService, userService, notificationService, authenticationService, router, datepipe) {\n      this.expenseService = expenseService;\n      this.userService = userService;\n      this.notificationService = notificationService;\n      this.authenticationService = authenticationService;\n      this.router = router;\n      this.datepipe = datepipe;\n      this.expenses = [];\n      this.user = new User();\n      this.totExpensesWeek = 0;\n      this.totExpenseMonth = 0;\n      this.subscriptions = [];\n      this.editExpense = new Expense(0, new Date(), 0, \"\", 0);\n      this.dateObj = new Date();\n    }\n    ngOnInit() {\n      this.user = this.authenticationService.getUserFromLocalCache();\n      this.getExpenses();\n    }\n    getExpenses() {\n      this.expenseService.getExpensesOfWeek(this.user.id).subscribe(response => {\n        this.expenses = response;\n        this.expenses.forEach(element => {\n          this.totExpensesWeek += element.value;\n        });\n        this.expenseService.getLastExpenseDate(this.user.id).subscribe(response => {\n          if (response != null) this.lastExpense = response.date;else this.lastExpense = null;\n        });\n        this.expenseService.getExpensesOfMonth(this.user.id).subscribe(response => {\n          response.forEach(element => {\n            this.totExpenseMonth += element.value;\n          });\n        });\n      });\n    }\n    logout() {\n      this.authenticationService.logout();\n      this.router.navigateByUrl(\"/login\");\n      this.notificationService.notify(NotificationType.SUCCESS, \"Logout eseguito correttamente.\");\n    }\n    sendNotification(notificationType, message) {\n      if (message) {\n        this.notificationService.notify(notificationType, message);\n      } else {\n        this.notificationService.notify(notificationType, 'An error occurred. Please try again.');\n      }\n    }\n    onEditExpense(editExpense) {\n      var _a;\n      this.editExpense = editExpense;\n      (_a = document.getElementById('openUserInfo')) === null || _a === void 0 ? void 0 : _a.click();\n      this.dateObj = editExpense.date;\n      console.log(\"Caricata : \" + editExpense.date);\n    }\n    updateExpense(editExpense) {\n      console.log(\"Inviata : \" + this.datepipe.transform(this.dateObj, \"yyyy-MM-dd\"));\n      this.editExpense.date = this.dateObj;\n      this.editExpense.user_id = this.authenticationService.getUserFromLocalCache().id;\n      this.expenseService.updateExpense(editExpense).subscribe(response => {\n        console.log(response);\n        this.notificationService.notify(NotificationType.SUCCESS, 'Aggiornamento completato correttamente.');\n      }, error => {\n        this.notificationService.notify(NotificationType.ERROR, error.message);\n      }, () => {\n        this.totExpenseMonth = 0;\n        this.totExpensesWeek = 0;\n        this.getExpenses();\n      });\n    }\n  }\n  HomepageComponent.ɵfac = function HomepageComponent_Factory(t) {\n    return new (t || HomepageComponent)(i0.ɵɵdirectiveInject(i1.ExpenseService), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.NotificationService), i0.ɵɵdirectiveInject(i4.AuthenticationService), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.DatePipe));\n  };\n  HomepageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomepageComponent,\n    selectors: [[\"app-homepage\"]],\n    decls: 102,\n    vars: 22,\n    consts: [[\"http-equiv\", \"Cache-Control\", \"content\", \"no-cache, must-revalidate\"], [1, \"navbar\", \"navbar-expand\", \"navbar-dark\", \"bg-dark\", \"mb-4\"], [\"href\", \"#\", 1, \"navbar-brand\"], [\"id\", \"myTab\", \"role\", \"tablist\", 1, \"navbar-nav\"], [1, \"nav-item\", \"active\"], [\"href\", \"search\", 1, \"nav-link\"], [1, \"nav-item\"], [\"href\", \"insert\", 1, \"nav-link\"], [1, \"container-xl\", \"px-4\", \"mt-4\"], [\"id\", \"cover-spin\"], [1, \"mt-0\", \"mb-4\"], [1, \"row\"], [1, \"col-lg-4\", \"mb-4\"], [1, \"card\", \"h-100\", \"border-start-lg\", \"border-start-primary\"], [1, \"card-body\"], [1, \"small\", \"text-muted\"], [1, \"h3\", 2, \"margin-top\", \"15px\"], [1, \"card\", \"h-100\", \"border-start-lg\", \"border-start-secondary\"], [1, \"card\", \"h-100\", \"border-start-lg\", \"border-start-success\"], [\"id\", \"home\", 1, \"tab-pane\", \"fade\", \"show\"], [1, \"card\", \"mb-4\"], [1, \"card-header\"], [1, \"card-body\", \"p-0\"], [1, \"table\", \"mb-0\", \"fixed\"], [\"scope\", \"col\", 1, \"border-gray\", \"fixed\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"logout\"], [1, \"btn\", \"btn-primary\", \"btn-lg\", 3, \"click\"], [\"type\", \"button\", \"id\", \"openUserInfo\", \"data-toggle\", \"modal\", \"data-target\", \"#viewUserModal\", 3, \"hidden\"], [\"id\", \"viewUserModal\", \"tabindex\", \"-1\", \"role\", \"dialog\", \"aria-labelledby\", \"\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\", \"bd-example-modal-lg\"], [\"role\", \"document\", 1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"exampleModalLongTitle\", 1, \"modal-title\", \"text-center\"], [1, \"text-center\", \"text-muted\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"close\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [1, \"card\"], [1, \"form-group\"], [\"for\", \"date\", 2, \"padding\", \"2px\", \"margin-top\", \"2px\"], [\"type\", \"date\", \"name\", \"date\", \"id\", \"date\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"change\", \"ngModelChange\"], [\"for\", \"value\", 2, \"padding\", \"2px\", \"margin-top\", \"8px\"], [\"type\", \"number\", \"name\", \"value\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"notes\", 2, \"padding\", \"2px\", \"margin-top\", \"2px\"], [\"type\", \"text\", \"name\", \"notes\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\"], [3, \"click\"]],\n    template: function HomepageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"head\");\n        i0.ɵɵelement(1, \"meta\", 0);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 1)(3, \"a\", 2)(4, \"h2\");\n        i0.ɵɵtext(5, \"Bankchecker\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\")(7, \"ul\", 3)(8, \"li\", 4)(9, \"a\", 5);\n        i0.ɵɵtext(10, \"Cerca Spese\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"li\", 6)(12, \"a\", 7);\n        i0.ɵɵtext(13, \"Inserisci Spesa\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(14, \"div\", 8);\n        i0.ɵɵelement(15, \"div\", 9)(16, \"hr\", 10);\n        i0.ɵɵelementStart(17, \"div\", 11)(18, \"div\", 12)(19, \"div\", 13)(20, \"div\", 14)(21, \"div\", 15);\n        i0.ɵɵtext(22, \"Spese della Settimana:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"div\", 16);\n        i0.ɵɵtext(24);\n        i0.ɵɵpipe(25, \"number\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(26, \"div\", 12)(27, \"div\", 17)(28, \"div\", 14)(29, \"div\", 15);\n        i0.ɵɵtext(30, \"Ultima spesa effettuata:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"div\", 16);\n        i0.ɵɵtext(32);\n        i0.ɵɵpipe(33, \"date\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(34, \"div\", 12)(35, \"div\", 18)(36, \"div\", 14)(37, \"div\", 15);\n        i0.ɵɵtext(38, \"Spese da inizio Mese:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"div\", 16);\n        i0.ɵɵtext(40);\n        i0.ɵɵpipe(41, \"number\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(42, \"div\", 19)(43, \"div\", 20)(44, \"div\", 21);\n        i0.ɵɵtext(45, \"Spese della settimana: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"div\", 22)(47, \"div\")(48, \"table\", 23)(49, \"thead\")(50, \"tr\")(51, \"th\", 24);\n        i0.ɵɵtext(52, \"Data\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(53, \"th\", 24);\n        i0.ɵɵtext(54, \"Spesa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"th\", 24);\n        i0.ɵɵtext(56, \"Note\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(57, \"tbody\");\n        i0.ɵɵtemplate(58, HomepageComponent_tr_58_Template, 8, 6, \"tr\", 25);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(59, HomepageComponent_div_59_Template, 5, 0, \"div\", 26);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(60, \"div\", 27)(61, \"button\", 28);\n        i0.ɵɵlistener(\"click\", function HomepageComponent_Template_button_click_61_listener() {\n          return ctx.logout();\n        });\n        i0.ɵɵtext(62, \"Logout\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(63, \"button\", 29);\n        i0.ɵɵelementStart(64, \"div\", 30)(65, \"div\", 31)(66, \"div\", 32)(67, \"div\", 33)(68, \"h5\", 34);\n        i0.ɵɵtext(69, \"Aggiorna Spesa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(70, \"div\", 35);\n        i0.ɵɵtext(71);\n        i0.ɵɵpipe(72, \"date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(73, \"button\", 36)(74, \"span\", 37);\n        i0.ɵɵtext(75, \"\\u00D7\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(76, \"div\", 38)(77, \"div\")(78, \"div\", 39)(79, \"div\", 14)(80, \"div\", 11)(81, \"div\")(82, \"div\", 40)(83, \"label\", 41)(84, \"h5\");\n        i0.ɵɵtext(85, \"Data:\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(86, \"input\", 42);\n        i0.ɵɵlistener(\"change\", function HomepageComponent_Template_input_change_86_listener($event) {\n          return ctx.dateObj = $event.target.valueAsDate;\n        })(\"ngModelChange\", function HomepageComponent_Template_input_ngModelChange_86_listener($event) {\n          return ctx.editExpense.date = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(87, \"div\", 40)(88, \"label\", 43)(89, \"h5\");\n        i0.ɵɵtext(90, \"Valore:\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(91, \"input\", 44);\n        i0.ɵɵlistener(\"ngModelChange\", function HomepageComponent_Template_input_ngModelChange_91_listener($event) {\n          return ctx.editExpense.value = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(92, \"div\", 40)(93, \"label\", 45)(94, \"h5\");\n        i0.ɵɵtext(95, \"Note:\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(96, \"input\", 46);\n        i0.ɵɵlistener(\"ngModelChange\", function HomepageComponent_Template_input_ngModelChange_96_listener($event) {\n          return ctx.editExpense.notes = $event;\n        });\n        i0.ɵɵelementEnd()()()()()()();\n        i0.ɵɵelementStart(97, \"div\", 47)(98, \"button\", 48);\n        i0.ɵɵlistener(\"click\", function HomepageComponent_Template_button_click_98_listener() {\n          return ctx.updateExpense(ctx.editExpense);\n        });\n        i0.ɵɵtext(99, \"Aggiorna\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(100, \"button\", 49);\n        i0.ɵɵtext(101, \"Chiudi\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(24);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(25, 10, ctx.totExpensesWeek, \".2-2\"), \"\\u20AC\");\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(33, 13, ctx.lastExpense, \"EEEE, d MMMM yyyy\"));\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(41, 16, ctx.totExpenseMonth, \".2-2\"), \"\\u20AC\");\n        i0.ɵɵadvance(18);\n        i0.ɵɵproperty(\"ngForOf\", ctx.expenses);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.expenses.length == 0);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"hidden\", true);\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate1(\" Spesa del giorno: \", i0.ɵɵpipeBind2(72, 19, ctx.editExpense.date, \"dd/MM/yyyy\"), \" \");\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngModel\", ctx.editExpense.date);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.editExpense.value);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.editExpense.notes);\n      }\n    },\n    directives: [i6.NgForOf, i6.NgIf, i7.DefaultValueAccessor, i7.RequiredValidator, i7.NgControlStatus, i7.NgModel, i7.NumberValueAccessor],\n    pipes: [i6.DecimalPipe, i6.DatePipe],\n    styles: [\"body[_ngcontent-%COMP%]{margin-top:20px;background-color:#f2f6fc;color:#69707a}.img-account-profile[_ngcontent-%COMP%]{height:10rem}.rounded-circle[_ngcontent-%COMP%]{border-radius:50%!important}.card[_ngcontent-%COMP%]{box-shadow:0 .15rem 1.75rem #21283226;text-align:center}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{font-weight:500}.card-header[_ngcontent-%COMP%]:first-child{border-radius:.35rem .35rem 0 0}.card-header[_ngcontent-%COMP%]{padding:1rem 1.35rem;margin-bottom:0;background-color:#21283208;border-bottom:1px solid rgba(33,40,50,.125)}.form-control[_ngcontent-%COMP%], .dataTable-input[_ngcontent-%COMP%]{display:block;width:100%;padding:.875rem 1.125rem;font-size:.875rem;font-weight:400;line-height:1;color:#69707a;background-color:#fff;background-clip:padding-box;border:1px solid #c5ccd6;-webkit-appearance:none;appearance:none;border-radius:.35rem;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.nav-borders[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#0061f2;border-bottom-color:#0061f2}.nav-borders[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#69707a;border-bottom-width:.125rem;border-bottom-style:solid;border-bottom-color:transparent;padding-top:.5rem;padding-bottom:.5rem;padding-left:0;padding-right:0;margin-left:1rem;margin-right:1rem}.fa-2x[_ngcontent-%COMP%]{font-size:2em}.table-billing-history[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-billing-history[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1.375rem}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%], .dataTable-table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.75rem;background-color:var(--bs-table-bg);border-bottom-width:1px;box-shadow:inset 0 0 0 9999px var(--bs-table-accent-bg)}.border-start-primary[_ngcontent-%COMP%]{border-left-color:#0061f2!important}.border-start-secondary[_ngcontent-%COMP%]{border-left-color:#6900c7!important}.border-start-success[_ngcontent-%COMP%]{border-left-color:#00ac69!important}.border-start-lg[_ngcontent-%COMP%]{border-left-width:.25rem!important}.h-100[_ngcontent-%COMP%]{height:100%!important}.navbar-brand[_ngcontent-%COMP%]{margin-left:20px}.navbar[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.navbar[_ngcontent-%COMP%]   .dropdown-item.active[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:active{color:inherit;text-decoration:none;background-color:inherit}.navbar[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:focus, .navbar[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{color:#16181b;text-decoration:none;background-color:#f8f9fa}.logout[_ngcontent-%COMP%]{text-align:center}.fixed[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;padding:18px}.fixed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:120px;vertical-align:middle;padding:18px;border-bottom:none;border-top:.1px solid grey}.fixed[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1.5px solid grey}.card[_ngcontent-%COMP%]{vertical-align:middle;text-align:center}#cover-spin[_ngcontent-%COMP%]{position:fixed;width:100%;inset:0;background-color:#ffffffb3;z-index:9999;opacity:0;display:block;animation:anime 1s 1;pointer-events:none}@keyframes anime{0%{opacity:1}50%{opacity:1}to{opacity:0;visibility:none}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#cover-spin[_ngcontent-%COMP%]:after{content:\\\"\\\";display:block;position:absolute;left:48%;top:40%;width:40px;height:40px;border-style:solid;border-color:#000;border-top-color:transparent;border-width:4px;border-radius:50%;animation:spin .8s linear infinite}@media (min-width: 767px){.navbar[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:not(.nav-link):after{width:0;height:0;margin-left:.5em;vertical-align:0;border-bottom:.3em solid transparent;border-top:.3em solid transparent;border-left:.3em solid}}\"]\n  });\n  return HomepageComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}